{"version":3,"sources":["../../app-es6/dao/NegociacaoDao.js"],"names":["Negociacao","NegociacaoDao","connection","_connection","_store","negociacao","Promise","resolve","reject","request","transaction","objectStore","add","onsuccess","onerror","console","log","e","target","error","negociacoes","cursor","openCursor","actual","event","result","data","value","push","_data","_quantidade","_valor","continue","name","clear"],"mappings":";;;;;;;;;;;;;;;AAAQA,gB,qBAAAA,U;;;;;;;;;;;;;;;;;;;;;+BACKC,a;AACX,+BAAYC,UAAZ,EAAuB;AAAA;;AACrB,eAAKC,WAAL,GAAmBD,UAAnB;AACA,eAAKE,MAAL,GAAc,aAAd;AACD;;;;8BAEGC,U,EAAW;AAAA;;AACb,mBAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAASC,MAAT,EAAmB;AACtC,kBAAIC,UAAU,MAAKN,WAAL,CACXO,WADW,CACC,CAAC,MAAKN,MAAN,CADD,EACgB,WADhB,EAEXO,WAFW,CAEC,MAAKP,MAFN,EAGXQ,GAHW,CAGPP,UAHO,CAAd;;AAMAI,sBAAQI,SAAR,GAAoB,aAAI;AACtBN;AACD,eAFD;AAGAE,sBAAQK,OAAR,GAAkB,aAAI;AACpBC,wBAAQC,GAAR,CAAYC,EAAEC,MAAF,CAASC,KAArB;AACAX,uBAAO,yCAAP;AACD,eAHD;AAKC,aAfM,CAAP;AAgBD;;;oCAEQ;AAAA;;AACP,mBAAO,IAAIF,OAAJ,CAAY,UAACC,OAAD,EAASC,MAAT,EAAoB;AACtC,kBAAIY,cAAc,EAAlB;;AAEA,kBAAIC,SAAS,OAAKlB,WAAL,CACXO,WADW,CACC,CAAC,OAAKN,MAAN,CADD,EACgB,WADhB,EAEXO,WAFW,CAEC,OAAKP,MAFN,EAGXkB,UAHW,EAAb;;AAMCD,qBAAOR,SAAP,GAAmB,iBAAS;AAC1B,oBAAIU,SAASC,MAAMN,MAAN,CAAaO,MAA1B;;AAEA,oBAAGF,MAAH,EAAU;AACR,sBAAIG,OAAOH,OAAOI,KAAlB;AACAP,8BAAYQ,IAAZ,CAAiB,IAAI5B,UAAJ,CAAe0B,KAAKG,KAApB,EAA2BH,KAAKI,WAAhC,EAA6CJ,KAAKK,MAAlD,CAAjB;;AAEAR,yBAAOS,QAAP;AAED,iBAND,MAMK;AACHzB,0BAAQa,WAAR;AACD;AACF,eAZD;;AAcAC,qBAAOP,OAAP,GAAiB,iBAAS;AACxBC,wBAAQC,GAAR,CAAYQ,MAAMN,MAAN,CAAaC,KAAb,CAAmBc,IAA/B;AACAzB,uBAAO,wCAAP;AACD,eAHD;AAID,aA3BM,CAAP;AA4BD;;;qCAES;AAAA;;AACT,mBAAO,IAAIF,OAAJ,CAAY,UAACC,OAAD,EAASC,MAAT,EAAoB;;AAEtC,kBAAIC,UAAU,OAAKN,WAAL,CACXO,WADW,CACC,CAAC,OAAKN,MAAN,CADD,EACgB,WADhB,EAEXO,WAFW,CAEC,OAAKP,MAFN,EAGX8B,KAHW,EAAd;;AAKAzB,sBAAQI,SAAR,GAAoB;AAAA,uBAAKN,QAAQ,kCAAR,CAAL;AAAA,eAApB;AACAE,sBAAQK,OAAR,GAAkB,aAAK;AACtBC,wBAAQC,GAAR,CAAYC,EAAEC,MAAF,CAASC,KAArB;AACAX,uBAAO,wCAAP;AACA,eAHD;AAKA,aAbM,CAAP;AAcA","file":"NegociacaoDao.js","sourcesContent":["import {Negociacao} from '../models/Negociacao';\r\nexport class NegociacaoDao {\r\n\t\tconstructor(connection){\r\n\t\t\t\tthis._connection = connection;\r\n\t\t\t\tthis._store = 'negociacoes';\r\n\t\t}\r\n\r\n\t\tadd(negociacao){\r\n\t\t\t\treturn new Promise((resolve,reject) =>{\r\n\t\t\t\tlet request = this._connection\r\n\t\t\t\t\t\t.transaction([this._store], 'readwrite')\r\n\t\t\t\t\t\t.objectStore(this._store)\r\n\t\t\t\t\t\t.add(negociacao);\r\n\r\n\t\t\t\t\t\t\r\n\t\t\t\trequest.onsuccess = e =>{\r\n\t\t\t\t\t\tresolve();\r\n\t\t\t\t};\r\n\t\t\t\trequest.onerror = e =>{\r\n\t\t\t\t\t\tconsole.log(e.target.error);\r\n\t\t\t\t\t\treject('Não foi possível adicionar a negociação');\r\n\t\t\t\t};\r\n\r\n\t\t\t\t})\r\n\t\t}\r\n\r\n\t\tlistAll(){\r\n\t\t\t\treturn new Promise((resolve,reject) => {\r\n\t\t\t\t\tlet negociacoes = [];\r\n\r\n\t\t\t\t\tlet cursor = this._connection\r\n\t\t\t\t\t\t.transaction([this._store], 'readwrite')\r\n\t\t\t\t\t\t.objectStore(this._store)\r\n\t\t\t\t\t\t.openCursor();\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\tcursor.onsuccess = event => {\r\n\t\t\t\t\t\t\t\tlet actual = event.target.result;\r\n\r\n\t\t\t\t\t\t\t\tif(actual){\r\n\t\t\t\t\t\t\t\t\t\tlet data = actual.value;\r\n\t\t\t\t\t\t\t\t\t\tnegociacoes.push(new Negociacao(data._data, data._quantidade, data._valor));\r\n\r\n\t\t\t\t\t\t\t\t\t\tactual.continue();\r\n\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\tresolve(negociacoes);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcursor.onerror = event => {\r\n\t\t\t\t\t\t\t\tconsole.log(event.target.error.name);\r\n\t\t\t\t\t\t\t\treject('Não foi possível listar as Negociações')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t}\r\n\r\n\t\tclearAll(){\r\n\t\t\treturn new Promise((resolve,reject) => {\r\n\r\n\t\t\t\tlet request = this._connection\r\n\t\t\t\t\t\t.transaction([this._store], 'readwrite')\r\n\t\t\t\t\t\t.objectStore(this._store)\r\n\t\t\t\t\t\t.clear();\r\n\r\n\t\t\t\trequest.onsuccess = e => resolve('Negociações apagadas com sucesso');\r\n\t\t\t\trequest.onerror = e => {\r\n\t\t\t\t\tconsole.log(e.target.error)\r\n\t\t\t\t\treject('Não foi possível apagar as negociações');\r\n\t\t\t\t}\r\n\r\n\t\t\t})\r\n\t\t}\r\n}"]}